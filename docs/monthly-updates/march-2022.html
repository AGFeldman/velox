
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>March 2022 Update &#8212; Velox  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="February 2022 Update" href="february-2022.html" />
    <link rel="prev" title="Monthly Updates" href="../monthly-updates.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="february-2022.html" title="February 2022 Update"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../monthly-updates.html" title="Monthly Updates"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Velox  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../monthly-updates.html" accesskey="U">Monthly Updates</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">March 2022 Update</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="march-2022-update">
<h1>March 2022 Update<a class="headerlink" href="#march-2022-update" title="Permalink to this headline">¶</a></h1>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Document <a class="reference internal" href="../develop/debugging/print-plan-with-stats.html"><span class="doc">printPlanWithStats</span></a> debugging tool.</p></li>
</ul>
</section>
<section id="core-library">
<h2>Core Library<a class="headerlink" href="#core-library" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Add support for UNNEST WITH ORDINALITY for single array or map.</p></li>
<li><p>Add support for filter to INNER and LEFT merge joins.</p></li>
<li><p>Add support for FULL OUTER hash join.</p></li>
<li><p>Add Substrait-to-Velox plan conversion.</p></li>
<li><p>Add exec::resolveAggregateFunction API to resolve aggregate function final and intermediate types based on function name and input types.</p></li>
<li><p>Add KLL sketch implementation to be used to implement <a class="reference internal" href="../functions/aggregate.html#id2" title="approx_percentile"><code class="xref py py-func docutils literal notranslate"><span class="pre">approx_percentile()</span></code></a> Presto function with accuracy parameter. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1247">#1247</a></p></li>
<li><p>Add GTest as a submodule and upgrade it to 1.11.0 (from 1.10.0).</p></li>
<li><p>Reduce dependencies for VELOX_BUILD_MINIMAL build by removing GTest, GMock and compression libraries. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1292">#1292</a></p></li>
<li><p>Simplify simple functions API to allow to provide void call method for functions that never return null for non-null inputs.</p></li>
<li><p>Optimize LocalMerge operator. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1264">#1264</a></p></li>
<li><p>Optimize PartitionedOutput and Exchange operators by removing unnecessary data copy. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1127">#1127</a></p></li>
<li><p>Optimize BaseVector::compare() for a pair of flat or a pair of constant vectors or scalar types. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1317">#1317</a></p></li>
<li><p>Optimize BaseVector::copy() for flat vectors of scalar type. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1316">#1316</a></p></li>
<li><p>Optimize aggregation by enabling pushdown into table scan in more cases. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1188">#1188</a></p></li>
<li><p>Optimize simple functions that never return null for non-null input for 70% perf boost. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1152">#1152</a></p></li>
<li><p>Fix bucket-by-bucket (grouped) execution of join queries.</p></li>
<li><p>Fix crashes and correctness bugs in joins and aggregations.</p></li>
</ul>
</section>
<section id="presto-functions">
<h2>Presto Functions<a class="headerlink" href="#presto-functions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Add support for CAST(x as JSON).</p></li>
<li><p>Add <a class="reference internal" href="../functions/array.html#arrays_overlap" title="arrays_overlap"><code class="xref py py-func docutils literal notranslate"><span class="pre">arrays_overlap()</span></code></a> function.</p></li>
<li><p>Extend <a class="reference internal" href="../functions/datetime.html#hour" title="hour"><code class="xref py py-func docutils literal notranslate"><span class="pre">hour()</span></code></a> function to support TIMESTAMP WITH TIME ZONE inputs.</p></li>
<li><p>Fix <a class="reference internal" href="../functions/datetime.html#parse_datetime" title="parse_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_datetime()</span></code></a> and <a class="reference internal" href="../functions/datetime.html#to_unixtime" title="to_unixtime"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_unixtime()</span></code></a> semantics. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1277">#1277</a></p></li>
<li><p>Fix <a class="reference internal" href="../functions/aggregate.html#id1" title="approx_distinct"><code class="xref py py-func docutils literal notranslate"><span class="pre">approx_distinct()</span></code></a> to return 0 instead of null with all inputs are null.</p></li>
</ul>
</section>
<section id="performance-and-correctness-testing">
<h2>Performance and Correctness Testing<a class="headerlink" href="#performance-and-correctness-testing" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Add linux-benchmarks-basic CircleCI job to run micro benchmarks on each PR. Initial set of benchmarks covers SelectivityVector, DecodedVector, simple comparisons and conjuncts.</p></li>
<li><p>Add TPC-H benchmark with support for q1, q6 and q18.</p></li>
<li><p>Add support for approximate verification of REAL and DOUBLE values returned by test queries.</p></li>
<li><p>Add support for ORDER BY SQL clauses to PlanBuilder::localMerge() and PlanBuilder::orderBy().</p></li>
</ul>
</section>
<section id="debugging-experience">
<h2>Debugging Experience<a class="headerlink" href="#debugging-experience" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Improve error messages in expression evaluation by including the expression being evaluated. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1138">#1138</a></p></li>
<li><p>Improve error messages in CAST expression by including the to and from types. <a class="reference external" href="https://github.com/facebookincubator/velox/pull/1150">#1150</a></p></li>
<li><p>Add printPlanWithStats function to print query plan with runtime statistics.</p></li>
<li><p>Add SelectivityVector::toString() method.</p></li>
<li><p>Improve ConstantExpr::toString() to include constant value.</p></li>
<li><p>Add runtime statistic “loadedToValueHook” to track number of values processed via aggregation pushdown into scan.</p></li>
</ul>
</section>
<section id="credits">
<h2>Credits<a class="headerlink" href="#credits" title="Permalink to this headline">¶</a></h2>
<p>Aditi Pandit, Amit Dutta, Amlan Nayak, Chad Austin, Chao Chen, David Greenberg,
Deepak Majeti, Dimitri Bouche, Gilson Takaasi Gil, Hanqi Wu, Huameng Jiang,
Jialiang Tan, im Meyering, Jimmy Lu, Karteek Murthy Samba Murthy, Kevin
Wilfong, Krishna Pai, Laith Sakka, Liang Tao, MJ Deng, Masha Basmanova, Orri
Erling, Paula Lahera, Pedro Eugenio Rocha Pedreira, Pradeep Garigipati, Richard
Barnes, Rui Mo, Sagar Mittal, Sergey Pershin, Simon Marlow, Siva Muthusamy,
Sridhar Anumandla, Victor Zverovich, Wei He, Wenlei Xie, Yoav Helfman, Yuan
Chao Chou, Zhenyuan Zhao, tanjialiang</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">March 2022 Update</a><ul>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#core-library">Core Library</a></li>
<li><a class="reference internal" href="#presto-functions">Presto Functions</a></li>
<li><a class="reference internal" href="#performance-and-correctness-testing">Performance and Correctness Testing</a></li>
<li><a class="reference internal" href="#debugging-experience">Debugging Experience</a></li>
<li><a class="reference internal" href="#credits">Credits</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../monthly-updates.html"
                          title="previous chapter">Monthly Updates</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="february-2022.html"
                          title="next chapter">February 2022 Update</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/monthly-updates/march-2022.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="february-2022.html" title="February 2022 Update"
             >next</a> |</li>
        <li class="right" >
          <a href="../monthly-updates.html" title="Monthly Updates"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Velox  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../monthly-updates.html" >Monthly Updates</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">March 2022 Update</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright TBD.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>